<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <title>Main page</title>
</head>

<body>
    <main>
        <section class="demo-mode">
            <img src="../assets/top-banner.png" alt="Top Banner" class="banner">
        </section>
        <section class="run-mode">
            <h2 class="title"></h2>
            <div class="content">
            </div>
        </section>
    </main>

    <script>
        const animationNames = ["rotate-x", "rotate-y", "rotate-z", "scale", "fade-in-out", "skew", "shake-x", "shake-y", "grayscale", "blur", "contrast", "hue-rotate"];
        let animationIndex = 0;
        const banner = document.querySelector(".banner");
        const demoModeSection = document.querySelector(".demo-mode");
        const runModeSection = document.querySelector(".run-mode");
        const randomIndicesBag = new Set();

        banner.style.setProperty("animation-name", animationNames[getRandomIndex(animationNames.length)]);
        banner.onanimationend = () => {
            const animationName = animationNames[getRandomIndex(animationNames.length)];
            banner.style.setProperty("animation-name", animationName);
        };

        demoModeSection.style.display = "none";
        runModeSection.style.display = "none";
        onmessage = ({ data }) => {
            if (data.type == "showDemoMode") {
                runModeSection.style.display = "none";
                demoModeSection.style.display = "flex";
            }
            if (data.type == "showRunStart") {
                demoModeSection.style.display = "none";
                runModeSection.style.display = "flex";
                runModeSection.querySelector(".title").textContent = data.description;
                runModeSection.querySelector(".content").textContent = data.content;
            }
            if (data.type == "showRunComplete") {
                runModeSection.querySelector(".title").textContent = "Run Complete";
                runModeSection.querySelector(".content").textContent = "";
            }
        };
        parent.postMessage({}, "*");

        function getRandomIndex(max) {
            let index;
            do {
                index = Math.floor(Math.random() * max);
            } while (randomIndicesBag.has(index));
            randomIndicesBag.add(index);
            if (randomIndicesBag.size >= max) {
                randomIndicesBag.clear();
            }
            return index;
        }
    </script>
</body>

</html>